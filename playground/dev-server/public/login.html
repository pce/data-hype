<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hype Playground — Login Example</title>
  <meta name="description" content="CSP-friendly login example for the Hype dev playground. Uses the external loader module for CSRF-aware login." />

  <!-- Keep styles CSP-friendly. Server will replace %CSP_NONCE% with a per-request nonce. -->
  <style nonce="%CSP_NONCE%">
    :root {
      --bg: #f8fafc;
      --card: #ffffff;
      --text: #0f172a;
      --muted: #64748b;
      --accent: #0366d6;
      --radius: 10px;
      --gap: 12px;
    }
    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .wrap { max-width: 720px; margin: 36px auto; padding: 18px; }
    .card { background: var(--card); border-radius: var(--radius); padding: 18px; box-shadow: 0 1px 2px rgba(2,6,23,0.06); }
    header .title { display:flex; gap:var(--gap); align-items:center; justify-content:space-between; flex-wrap:wrap; }
    h1 { margin: 0; font-size: 1.25rem; }
    p.lead { margin: 6px 0 0; color: var(--muted); }
    form { display: grid; gap: 10px; margin-top: 12px; }
    label { display:block; font-size: .95rem; color: var(--muted); }
    input[type="text"], input[type="password"] {
      padding: 10px;
      border: 1px solid #e6eef6;
      border-radius: 8px;
      font-size: 1rem;
      width: 100%;
      box-sizing: border-box;
    }
    .controls { display:flex; gap:12px; align-items:center; margin-top:8px; }
    button.primary {
      background: var(--accent);
      color: white;
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
    }
    a.link { color: var(--accent); text-decoration: none; font-size: .95rem; }
    .meta { font-size: .92rem; color: var(--muted); margin-top: 12px; }
    [data-login-message] { margin-top: 6px; font-size: .95rem; min-height: 1.2em; }
    .ok { color: green; }
    .error { color: #b91c1c; }
    footer { margin-top: 18px; font-size: .9rem; color: var(--muted); }
    @media (max-width:520px) { .wrap { padding: 12px; } .controls { flex-direction: column; align-items: stretch; } }
  </style>
</head>
<body>
  <div class="wrap">
    <header class="card" role="banner" aria-label="Hype Playground header">
      <div class="title">
        <div>
          <h1>Hype — Playground (dev)</h1>
          <p class="lead">Login example demonstrating CSRF-aware auth using the external loader module.</p>
        </div>
        <div style="text-align:right">
          <a class="link" href="/">← Back to examples</a>
        </div>
      </div>
    </header>

    <main class="card" role="main" aria-labelledby="login-title" style="margin-top:16px">
      <h2 id="login-title" style="margin:0 0 8px 0">Sign in</h2>

      <!-- Progressive enhancement: the form works without JS; the external loader binds it when available. -->
      <form id="login-form" class="hype-login-form" method="post" action="/login" aria-label="Login form">
        <label for="username">Username
          <input id="username" name="username" type="text" autocomplete="username" required />
        </label>

        <label for="password">Password
          <input id="password" name="password" type="password" autocomplete="current-password" required />
        </label>

        <div class="controls" role="group" aria-label="Form actions">
          <button type="submit" class="primary">Sign in</button>
          <a class="link" href="/reactive_counter.html">Try reactive counter</a>
        </div>

        <!-- Loader will display messages here when it binds the form -->
        <div data-login-message aria-live="polite" aria-atomic="true"></div>
      </form>

      <div class="meta">
        <ul></ul>
          <li>The loader fetches a CSRF token from <code>/csrf-token</code> before posting credentials to <code>/login</code>.</li>
          <li>On successful login the loader dispatches a DOM event <code>auth:</code>login</code> so other scripts can react.</li>
        </ul>
      </div>
    </main>

    <footer class="card" role="contentinfo" style="margin-top:16px">
      Hype playground — dev • tighten CSP & auth for production
    </footer>
  </div>

  <!-- External loader module wires auth bindings & attempts to load the Hype runtime.
       Include a nonce placeholder so the server can inject a per-request nonce if desired. -->
  <script nonce="%CSP_NONCE%" type="module" src="/static/js/loader.js"></script>
</body>
</html>
