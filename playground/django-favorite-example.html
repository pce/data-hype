<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Django Favorite Button - Hype Reactive Example</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .hype-loading {
      opacity: 0.6;
      pointer-events: none;
    }
    
    .heart-icon {
      transition: transform 0.2s ease;
    }
    
    .heart-icon.active {
      animation: heartbeat 0.3s ease;
    }
    
    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      25% { transform: scale(1.3); }
      50% { transform: scale(1.1); }
      75% { transform: scale(1.2); }
    }
  </style>
</head>
<body class="bg-gray-100 p-8">
  <div class="max-w-4xl mx-auto">
    <header class="mb-8">
      <h1 class="text-3xl font-bold text-gray-900 mb-2">Django Favorite Button Example</h1>
      <p class="text-gray-600">Replacing verbose Django + JavaScript with Hype Reactive</p>
    </header>

    <!-- Before: Traditional Django + JavaScript approach -->
    <section class="bg-white rounded-lg shadow-lg p-6 mb-8">
      <h2 class="text-2xl font-semibold mb-4 text-gray-800">‚ùå Before: Traditional Approach</h2>
      <p class="text-sm text-gray-600 mb-4">Requires Django template logic + custom JavaScript + manual DOM manipulation</p>
      
      <div class="bg-gray-50 p-4 rounded border border-gray-200 mb-4">
        <p class="text-xs font-mono text-gray-500 mb-2">Django Template:</p>
        <pre class="text-xs overflow-x-auto"><code>{% if user.is_authenticated %}
&lt;button 
  class="btn btn-square btn-ghost favorite-btn" 
  data-job-id="{{ job.id }}"
  data-favorited="{% if job in user.profile.favorite_jobs.all %}true{% else %}false{% endif %}"
&gt;
  {% if job in user.profile.favorite_jobs.all %}
    &lt;!-- Filled heart --&gt;
    &lt;svg class="size-[1.2em] text-red-500"&gt;...&lt;/svg&gt;
  {% else %}
    &lt;!-- Outline heart --&gt;
    &lt;svg class="size-[1.2em]"&gt;...&lt;/svg&gt;
  {% endif %}
&lt;/button&gt;
{% endif %}</code></pre>
      </div>

      <div class="bg-gray-50 p-4 rounded border border-gray-200">
        <p class="text-xs font-mono text-gray-500 mb-2">JavaScript (50+ lines):</p>
        <pre class="text-xs overflow-x-auto"><code>document.addEventListener('DOMContentLoaded', function() {
  const favoriteButtons = document.querySelectorAll('.favorite-btn');
  favoriteButtons.forEach(button => {
    button.addEventListener('click', function(e) {
      e.preventDefault();
      const jobId = this.getAttribute('data-job-id');
      const isFavorited = this.getAttribute('data-favorited') === 'true';
      this.disabled = true;
      
      fetch(`/jobs/${jobId}/toggle-favorite/`, {
        method: 'POST',
        headers: { 'X-CSRFToken': getCookie('csrftoken') }
      })
      .then(response => response.json())
      .then(data => {
        this.setAttribute('data-favorited', data.is_favorited);
        // Manual DOM manipulation to swap icons...
        this.innerHTML = data.is_favorited ? '...' : '...';
        this.disabled = false;
      });
    });
  });
});</code></pre>
      </div>
    </section>

    <!-- After: Hype Reactive approach -->
    <section class="bg-white rounded-lg shadow-lg p-6 mb-8">
      <h2 class="text-2xl font-semibold mb-4 text-green-700">‚úÖ After: Hype Reactive</h2>
      <p class="text-sm text-gray-600 mb-4">Clean markup, no custom JavaScript needed!</p>
      
      <div class="bg-gray-50 p-4 rounded border border-green-200">
        <p class="text-xs font-mono text-gray-500 mb-2">Django Template (simplified):</p>
        <pre class="text-xs overflow-x-auto"><code>&lt;button
  data-hype-state='{ "favorited": {{ "true" if job in user.profile.favorite_jobs.all else "false" }} }'
  data-hype-post="{% url 'toggle_job_favorite' job.id %}"
  data-hype-swap="none"
  data-hype-on-click="toggle('favorited'); $fetch()"
  class="btn btn-square btn-ghost"
&gt;
  &lt;!-- Outline heart - auto-shown when NOT favorited --&gt;
  &lt;svg data-hype-show="!favorited" class="size-[1.2em]"&gt;...&lt;/svg&gt;
  
  &lt;!-- Filled heart - auto-shown when favorited --&gt;
  &lt;svg data-hype-show="favorited" class="size-[1.2em] text-red-500"&gt;...&lt;/svg&gt;
&lt;/button&gt;</code></pre>
      </div>
      
      <div class="mt-4 p-3 bg-green-50 border-l-4 border-green-500 rounded">
        <p class="text-sm text-green-800"><strong>Benefits:</strong></p>
        <ul class="text-sm text-green-700 mt-2 space-y-1 ml-4 list-disc">
          <li>No custom JavaScript required</li>
          <li>Optimistic UI updates (instant feedback)</li>
          <li>Automatic icon swapping based on state</li>
          <li>Built-in CSRF handling via Hype</li>
          <li>Progressive enhancement ready</li>
        </ul>
      </div>
    </section>

    <!-- Live Demo -->
    <section class="bg-white rounded-lg shadow-lg p-6">
      <h2 class="text-2xl font-semibold mb-4 text-gray-800">üéØ Live Demo</h2>
      <p class="text-gray-600 mb-6">Try clicking the hearts below (simulated - no real backend)</p>

      <!-- Job List Example -->
      <div class="space-y-4">
        <!-- Job 1 -->
        <div class="border border-gray-200 rounded-lg p-4 flex items-start gap-4">
          <div class="flex-1">
            <h3 class="text-lg font-semibold text-gray-900">Senior Python Developer</h3>
            <p class="text-sm text-gray-600 mt-1">Remote ‚Ä¢ $120k-$150k ‚Ä¢ Posted 2 days ago</p>
          </div>
          
          <button
            data-hype-state='{ "favorited": false }'
            data-hype-post="/api/jobs/123/toggle-favorite"
            data-hype-swap="none"
            data-hype-on-click="toggle('favorited')"
            class="btn btn-square btn-ghost p-2 hover:bg-gray-100 rounded-lg transition-colors"
            title="Toggle favorite"
          >
            <!-- Outline heart -->
            <svg 
              data-hype-show="!favorited" 
              class="size-6 heart-icon" 
              xmlns="http://www.w3.org/2000/svg" 
              viewBox="0 0 24 24"
            >
              <g stroke-linejoin="round" stroke-linecap="round" stroke-width="2" fill="none" stroke="currentColor">
                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path>
              </g>
            </svg>
            
            <!-- Filled heart -->
            <svg 
              data-hype-show="favorited" 
              class="size-6 text-red-500 heart-icon active" 
              xmlns="http://www.w3.org/2000/svg" 
              viewBox="0 0 24 24" 
              fill="currentColor"
            >
              <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path>
            </svg>
          </button>
        </div>

        <!-- Job 2 (initially favorited) -->
        <div class="border border-gray-200 rounded-lg p-4 flex items-start gap-4">
          <div class="flex-1">
            <h3 class="text-lg font-semibold text-gray-900">Full Stack Engineer</h3>
            <p class="text-sm text-gray-600 mt-1">New York, NY ‚Ä¢ $130k-$160k ‚Ä¢ Posted 5 days ago</p>
          </div>
          
          <button
            data-hype-state='{ "favorited": true }'
            data-hype-post="/api/jobs/456/toggle-favorite"
            data-hype-swap="none"
            data-hype-on-click="toggle('favorited')"
            class="btn btn-square btn-ghost p-2 hover:bg-gray-100 rounded-lg transition-colors"
            title="Toggle favorite"
          >
            <!-- Outline heart -->
            <svg 
              data-hype-show="!favorited" 
              class="size-6 heart-icon" 
              xmlns="http://www.w3.org/2000/svg" 
              viewBox="0 0 24 24"
            >
              <g stroke-linejoin="round" stroke-linecap="round" stroke-width="2" fill="none" stroke="currentColor">
                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path>
              </g>
            </svg>
            
            <!-- Filled heart -->
            <svg 
              data-hype-show="favorited" 
              class="size-6 text-red-500 heart-icon active" 
              xmlns="http://www.w3.org/2000/svg" 
              viewBox="0 0 24 24" 
              fill="currentColor"
            >
              <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path>
            </svg>
          </button>
        </div>

        <!-- Job 3 -->
        <div class="border border-gray-200 rounded-lg p-4 flex items-start gap-4">
          <div class="flex-1">
            <h3 class="text-lg font-semibold text-gray-900">Django Backend Developer</h3>
            <p class="text-sm text-gray-600 mt-1">San Francisco, CA ‚Ä¢ $140k-$180k ‚Ä¢ Posted 1 week ago</p>
          </div>
          
          <button
            data-hype-state='{ "favorited": false }'
            data-hype-post="/api/jobs/789/toggle-favorite"
            data-hype-swap="none"
            data-hype-on-click="toggle('favorited')"
            class="btn btn-square btn-ghost p-2 hover:bg-gray-100 rounded-lg transition-colors"
            title="Toggle favorite"
          >
            <!-- Outline heart -->
            <svg 
              data-hype-show="!favorited" 
              class="size-6 heart-icon" 
              xmlns="http://www.w3.org/2000/svg" 
              viewBox="0 0 24 24"
            >
              <g stroke-linejoin="round" stroke-linecap="round" stroke-width="2" fill="none" stroke="currentColor">
                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path>
              </g>
            </svg>
            
            <!-- Filled heart -->
            <svg 
              data-hype-show="favorited" 
              class="size-6 text-red-500 heart-icon active" 
              xmlns="http://www.w3.org/2000/svg" 
              viewBox="0 0 24 24" 
              fill="currentColor"
            >
              <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path>
            </svg>
          </button>
        </div>
      </div>
    </section>

    <!-- Django Integration Guide -->
    <section class="bg-blue-50 rounded-lg border border-blue-200 p-6 mt-8">
      <h2 class="text-xl font-semibold mb-4 text-blue-900">üîß Django Integration</h2>
      
      <div class="space-y-4">
        <div>
          <h3 class="font-semibold text-blue-800 mb-2">1. Template (jobs/list.html)</h3>
          <pre class="bg-white p-3 rounded text-xs overflow-x-auto border border-blue-200"><code>{% for job in jobs %}
&lt;div class="job-card"&gt;
  &lt;h3&gt;{{ job.title }}&lt;/h3&gt;
  
  &lt;button
    data-hype-state='{ "favorited": {{ "true" if job in user.profile.favorite_jobs.all else "false" }} }'
    data-hype-post="{% url 'toggle_job_favorite' job.id %}"
    data-hype-swap="none"
    data-hype-on-click="toggle('favorited'); $fetch()"
    class="favorite-btn"
  &gt;
    &lt;svg data-hype-show="!favorited"&gt;{# outline heart #}&lt;/svg&gt;
    &lt;svg data-hype-show="favorited"&gt;{# filled heart #}&lt;/svg&gt;
  &lt;/button&gt;
&lt;/div&gt;
{% endfor %}</code></pre>
        </div>

        <div>
          <h3 class="font-semibold text-blue-800 mb-2">2. View (views.py)</h3>
          <pre class="bg-white p-3 rounded text-xs overflow-x-auto border border-blue-200"><code>from django.http import JsonResponse
from django.views.decorators.http import require_POST

@require_POST
@login_required
def toggle_job_favorite(request, job_id):
    job = get_object_or_404(Job, id=job_id)
    profile = request.user.profile
    
    if job in profile.favorite_jobs.all():
        profile.favorite_jobs.remove(job)
        is_favorited = False
    else:
        profile.favorite_jobs.add(job)
        is_favorited = True
    
    return JsonResponse({
        'success': True,
        'is_favorited': is_favorited
    })</code></pre>
        </div>

        <div>
          <h3 class="font-semibold text-blue-800 mb-2">3. URL (urls.py)</h3>
          <pre class="bg-white p-3 rounded text-xs overflow-x-auto border border-blue-200"><code>urlpatterns = [
    path('jobs/&lt;int:job_id&gt;/toggle-favorite/', 
         views.toggle_job_favorite, 
         name='toggle_job_favorite'),
]</code></pre>
        </div>

        <div>
          <h3 class="font-semibold text-blue-800 mb-2">4. Initialize Hype (base.html)</h3>
          <pre class="bg-white p-3 rounded text-xs overflow-x-auto border border-blue-200"><code>&lt;script type="module"&gt;
  import { hype } from '/static/js/hype.js';
  hype.init();
&lt;/script&gt;</code></pre>
        </div>
      </div>
    </section>

    <!-- Key Features -->
    <section class="mt-8 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6 border border-purple-200">
      <h2 class="text-xl font-semibold mb-4 text-purple-900">‚ú® Key Features</h2>
      <div class="grid md:grid-cols-2 gap-4">
        <div class="bg-white p-4 rounded-lg shadow-sm">
          <h3 class="font-semibold text-purple-800 mb-2">‚ö° Optimistic Updates</h3>
          <p class="text-sm text-gray-600">UI updates instantly, then syncs with server</p>
        </div>
        <div class="bg-white p-4 rounded-lg shadow-sm">
          <h3 class="font-semibold text-purple-800 mb-2">üîí CSRF Built-in</h3>
          <p class="text-sm text-gray-600">Automatic CSRF token handling</p>
        </div>
        <div class="bg-white p-4 rounded-lg shadow-sm">
          <h3 class="font-semibold text-purple-800 mb-2">üì¶ No Dependencies</h3>
          <p class="text-sm text-gray-600">Pure JavaScript, no jQuery or Alpine needed</p>
        </div>
        <div class="bg-white p-4 rounded-lg shadow-sm">
          <h3 class="font-semibold text-purple-800 mb-2">‚ôø Progressive Enhancement</h3>
          <p class="text-sm text-gray-600">Works without JavaScript (form fallback)</p>
        </div>
      </div>
    </section>
  </div>

  <script type="module">
    // Simulated Hype initialization
    console.log('üéâ Hype Reactive Demo loaded!');
    console.log('In production: import { hype } from "hype"; hype.init();');
  </script>
</body>
</html>